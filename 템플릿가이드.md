# 템플릿 연동 가이드

## 📌 개요

CMS AI 템플릿 시스템은 사전 정의된 HTML 템플릿에 AI가 생성한 콘텐츠를 동적으로 삽입하는 구조입니다. 이 문서는 실제 서비스 개발 시 템플릿을 연동하는 방법을 설명합니다.

## 🏗️ 시스템 아키텍처

```
[템플릿 선택] → [AI 콘텐츠 생성] → [템플릿 + 콘텐츠 결합] → [JSON 저장] → [사이트 배포]
```

### 핵심 구성 요소

1. **템플릿 파일** (`/templates/*.html`)
   - 사이트의 전체 HTML 구조
   - 템플릿 변수 포함
   - AI 콘텐츠 삽입 영역 정의

2. **템플릿 API** (`/api/get-template.jsp`)
   - 템플릿 로드 및 메타데이터 제공

3. **콘텐츠 저장소** (`/data/[siteId]/[menuId]/[submenuId].json`)
   - AI가 생성한 콘텐츠 저장
   - 메타데이터 및 버전 관리

## 🎨 템플릿 구조

### 필수 요소

#### 1. 템플릿 변수
```html
<!-- 페이지 제목 -->
<title>{{PAGE_TITLE}} | {{SITE_NAME}}</title>

<!-- 사이트 이름 -->
<h1 class="logo">{{SITE_NAME}}</h1>

<!-- 네비게이션 메뉴 -->
<ul class="nav-menu">
    {{MENU_NAVIGATION}}
</ul>

<!-- 브레드크럼 -->
<span>{{BREADCRUMB_SECTION}}</span>
<span>{{BREADCRUMB_PAGE}}</span>
```

#### 2. AI 콘텐츠 영역
```html
<!-- AI가 생성한 콘텐츠가 삽입될 영역 -->
<div class="content cms-print" id="cms-content">
    <!-- 기본 플레이스홀더 (선택사항) -->
    <div class="cms-placeholder">
        이 영역에 AI 콘텐츠가 삽입됩니다
    </div>
</div>
```

### 템플릿 예시 (university-ewha.html)
```html
<!DOCTYPE html>
<html lang="ko">
<head>
    <title>{{PAGE_TITLE}} | {{SITE_NAME}}</title>
    <meta charset="UTF-8">
    <style>
        /* 템플릿 스타일 */
    </style>
</head>
<body>
    <header>
        <h1>{{SITE_NAME}}</h1>
        <nav>{{MENU_NAVIGATION}}</nav>
    </header>
    
    <main>
        <div class="breadcrumb">
            <span>{{BREADCRUMB_SECTION}}</span> > 
            <span>{{BREADCRUMB_PAGE}}</span>
        </div>
        
        <!-- AI 콘텐츠 영역 -->
        <div id="cms-content">
            <!-- AI가 생성한 콘텐츠가 여기에 삽입됨 -->
        </div>
    </main>
    
    <footer>
        <!-- 푸터 내용 -->
    </footer>
</body>
</html>
```

## 🔌 API 연동

### 1. 템플릿 로드
```javascript
// 템플릿 ID로 템플릿 가져오기
const response = await fetch('/api/get-template.jsp?templateId=university-ewha');
const result = await response.json();

if (result.success) {
    const templateHTML = result.data.templateHTML;
    const templateName = result.data.templateName;
    const templateCategory = result.data.category;
}
```

### 2. AI 콘텐츠 생성 및 저장
```javascript
// AI가 생성한 콘텐츠 저장
const pageData = {
    siteId: 'ewha',
    menuId: 'about',
    submenuId: 'welcome',
    title: '환영 인사',
    cmsContentHTML: '<div>AI가 생성한 HTML 콘텐츠</div>',
    metadata: {
        generatedAt: new Date().toISOString(),
        version: 1
    }
};

const response = await fetch('/api/save-page.jsp', {
    method: 'POST',
    body: new URLSearchParams(pageData)
});
```

### 3. 저장된 콘텐츠 로드
```javascript
// 저장된 페이지 콘텐츠 가져오기
const response = await fetch('/api/load-page.jsp?siteId=ewha&menuId=about&submenuId=welcome');
const result = await response.json();

if (result.success) {
    const pageData = result.data.pageData;
    const cmsContent = pageData.cmsContentHTML;
}
```

## 🚀 실제 서비스 통합 시나리오

### 1단계: 사이트 생성 플로우
```
1. 사용자가 템플릿 선택 (university, corporate, government 등)
2. 사이트 기본 정보 입력 (사이트명, 도메인, 메뉴 구조)
3. 템플릿 ID와 사이트 정보를 CMS 위자드에 전달
```

### 2단계: 콘텐츠 생성
```javascript
// URL 파라미터로 템플릿과 사이트 정보 전달
const wizardUrl = `/cms-wizard/index.html?siteId=${siteId}&templateId=${templateId}`;

// 또는 API로 초기화
const initData = {
    siteId: 'company123',
    templateId: 'corporate-tech',
    siteName: '테크 기업',
    domain: 'company123.com',
    menuStructure: [...] // 메뉴 구조
};
```

### 3단계: 템플릿과 콘텐츠 결합
```javascript
class TemplateProcessor {
    async processTemplate(templateHTML, pageData) {
        let html = templateHTML;
        
        // 템플릿 변수 치환
        html = html.replace(/{{PAGE_TITLE}}/g, pageData.title);
        html = html.replace(/{{SITE_NAME}}/g, pageData.siteName);
        html = html.replace(/{{BREADCRUMB_SECTION}}/g, pageData.section);
        html = html.replace(/{{BREADCRUMB_PAGE}}/g, pageData.page);
        html = html.replace(/{{MENU_NAVIGATION}}/g, this.generateMenu(pageData.menuId));
        
        // AI 콘텐츠 삽입
        const cmsRegex = /<div[^>]*id="cms-content"[^>]*>[\s\S]*?<\/div>[\s]*<\/div>/;
        html = html.replace(cmsRegex, 
            `<div id="cms-content">${pageData.cmsContentHTML}</div>`
        );
        
        return html;
    }
}
```

### 4단계: 사이트 배포
```javascript
// 생성된 모든 페이지를 실제 서비스로 배포
async function deploySite(siteId) {
    // 1. 모든 페이지 데이터 수집
    const pages = await getAllPages(siteId);
    
    // 2. 템플릿 로드
    const template = await loadTemplate(templateId);
    
    // 3. 각 페이지별 HTML 생성
    for (const page of pages) {
        const html = await processTemplate(template, page);
        await deployPage(siteId, page.url, html);
    }
    
    // 4. 도메인 연결 및 활성화
    await activateSite(siteId, domain);
}
```

## 🎯 새 템플릿 추가 가이드

### 1. 템플릿 파일 생성
```bash
# 새 템플릿 파일 생성
/templates/corporate-modern.html
```

### 2. 템플릿 등록
```java
// get-template.jsp에 템플릿 정보 추가
private String getTemplateName(String templateId) {
    templateNames.put("corporate-modern", "모던 기업 템플릿");
    // ...
}

private String getTemplateDescription(String templateId) {
    descriptions.put("corporate-modern", "현대적인 기업 웹사이트 템플릿");
    // ...
}
```

### 3. 템플릿 변수 정의
```html
<!-- 필수 템플릿 변수 -->
{{SITE_NAME}}          <!-- 사이트 이름 -->
{{PAGE_TITLE}}         <!-- 페이지 제목 -->
{{PAGE_SUBTITLE}}      <!-- 페이지 부제목 -->
{{MENU_NAVIGATION}}    <!-- 메뉴 HTML -->
{{BREADCRUMB_SECTION}} <!-- 브레드크럼 섹션 -->
{{BREADCRUMB_PAGE}}    <!-- 브레드크럼 페이지 -->

<!-- 커스텀 변수 추가 가능 -->
{{COMPANY_LOGO}}       <!-- 회사 로고 -->
{{CONTACT_INFO}}       <!-- 연락처 정보 -->
{{SOCIAL_LINKS}}       <!-- 소셜 미디어 링크 -->
```

## ✅ 통합 체크리스트

### 개발 전
- [ ] 템플릿 디자인 완성
- [ ] 템플릿 변수 정의
- [ ] AI 콘텐츠 영역 표시
- [ ] 메뉴 구조 정의

### 개발 중
- [ ] 템플릿 파일 생성 (`/templates/`)
- [ ] 템플릿 API 연동 테스트
- [ ] AI 콘텐츠 생성 테스트
- [ ] 템플릿 변수 치환 검증
- [ ] 콘텐츠 저장/로드 테스트

### 배포 전
- [ ] 모든 페이지 생성 완료 확인
- [ ] 콘텐츠 품질 검토
- [ ] 반응형 디자인 테스트
- [ ] 브라우저 호환성 테스트
- [ ] 성능 최적화

## 🔧 문제 해결

### 템플릿이 로드되지 않을 때
```javascript
// 템플릿 로드 디버깅
console.log('템플릿 ID:', templateId);
console.log('API 응답:', result);

// 템플릿 파일 존재 확인
ls -la /templates/
```

### AI 콘텐츠가 표시되지 않을 때
```javascript
// DOM 구조 확인
const cmsElement = document.getElementById('cms-content');
console.log('CMS 영역 존재:', !!cmsElement);

// 저장된 콘텐츠 확인
cat /data/[siteId]/[menuId]/[submenuId].json
```

### 템플릿 변수가 치환되지 않을 때
```javascript
// 변수 치환 로그
console.log('치환 전:', html.includes('{{PAGE_TITLE}}'));
console.log('치환 후:', html.includes(pageTitle));
```

## 📚 참고 자료

- [README.md](README.md) - 프로젝트 전체 가이드
- [CLAUDE.md](cms-wizard/CLAUDE.md) - AI 어시스턴트 가이드
- [API 문서](README.md#-api-엔드포인트) - API 상세 스펙

## 🤝 지원

템플릿 연동 관련 문의사항이 있으시면 개발팀에 문의해주세요.

---

작성일: 2025-08-06  
버전: 1.0.0